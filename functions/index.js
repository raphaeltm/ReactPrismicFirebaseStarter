!function(e,t){for(var n in t)e[n]=t[n]}(this,function(e){function t(r){if(n[r])return n[r].exports;var u=n[r]={i:r,l:!1,exports:{}};return e[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t){e.exports=require("prismic-javascript")},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(u,o){try{var i=t[u](o),a=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}return r("next")})}}n(2);var i=n(3),a=r(i),c=n(4),s=r(c),p=n(5),f=function(){var e=o(regeneratorRuntime.mark(function e(){var t,n,r,o,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=50,e.next=3,(0,p.getApi)();case 3:return n=e.sent,r=[],e.next=7,n.query([],{pageSize:t,page:1});case 7:o=e.sent,r=[].concat(u(r),u(o.results)),i=2;case 10:if(!(i<=o.total_pages)){e.next=18;break}return e.next=13,n.query([],{pageSize:t,page:i});case 13:a=e.sent,r=[].concat(u(r),u(a.results));case 15:i++,e.next=10;break;case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),l=function(e){var t=[];return e.map(function(e){t.push({url:(0,p.linkResolver)(e)})}),t};t.siteMap=a.https.onRequest(function(){var e=o(regeneratorRuntime.mark(function e(t,n){var r,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:r=e.sent,u=s.createSitemap({hostname:t.protocol+"://"+t.hostname,cacheTime:6e5,urls:l(r)}),u.toXML(function(e,t){if(e)return n.status(500).end();n.header("Content-Type","application/xml"),n.set("Cache-Control","public, max-age=1800, s-maxage=3600"),n.send(t)});case 5:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}())},function(e,t){e.exports=require("babel-polyfill")},function(e,t){e.exports=require("firebase-functions")},function(e,t){e.exports=require("sitemap")},function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(u,o){try{var i=t[u](o),a=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}return r("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.linkResolver=t.getApi=void 0;var u=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(u),i=n(6);t.getApi=function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.getApi(i.apiEndpoint);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.linkResolver=i.linkResolver},function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(u,o){try{var i=t[u](o),a=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}return r("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadSettings=t.linkResolver=t.getApi=t.apiEndpoint=void 0;var u=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(u),i=n(7),a=t.apiEndpoint="https://raphaeltm.prismic.io/api/v2",c=t.getApi=function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.getApi(a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();t.linkResolver=function(e){return"homepage"===e.type?"/":"/"+e.type+"/"+(e.uid||"")},t.loadSettings=function(){var e=r(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return n=e.sent,e.next=5,n.query(o.default.Predicates.at("document.type","settings"));case 5:return r=e.sent,1===r.results.length&&t.dispatch((0,i.contentLoaded)(r.results[0],"settings")),e.abrupt("return",r.results[0]);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.CONTENT_LOADED="CONTENT_LOADED",u=t.CONTENT_FETCHING="CONTENT_FETCHING";t.contentFetching=function(){return{type:u}},t.contentLoaded=function(e,t,n){return{type:r,payload:{content:e,type:t,uid:n}}}}]));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5kZXguanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIGQwYzA4NmFkMWY1MGI4N2M5MGU5Iiwid2VicGFjazovLy9leHRlcm5hbCBcInByaXNtaWMtamF2YXNjcmlwdFwiIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJiYWJlbC1wb2x5ZmlsbFwiIiwid2VicGFjazovLy9leHRlcm5hbCBcImZpcmViYXNlLWZ1bmN0aW9uc1wiIiwid2VicGFjazovLy9leHRlcm5hbCBcInNpdGVtYXBcIiIsIndlYnBhY2s6Ly8vLi9zcmMvcHJpc21pYy5qcyIsIndlYnBhY2s6Ly8vLi8uLi9zcmMvcHJpc21pYy5qcyIsIndlYnBhY2s6Ly8vLi8uLi9zcmMvYWN0aW9ucy9jb250ZW50LmpzIl0sIm5hbWVzIjpbImUiLCJhIiwiaSIsInRoaXMiLCJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJsIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJyZXF1aXJlIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJvYmoiLCJuZXdPYmoiLCJrZXkiLCJkZWZhdWx0IiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiYXJyIiwiQXJyYXkiLCJpc0FycmF5IiwiYXJyMiIsImxlbmd0aCIsImZyb20iLCJfYXN5bmNUb0dlbmVyYXRvciIsImZuIiwiZ2VuIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInN0ZXAiLCJhcmciLCJpbmZvIiwidmFsdWUiLCJlcnJvciIsImRvbmUiLCJ0aGVuIiwiZXJyIiwiX2ZpcmViYXNlRnVuY3Rpb25zIiwiZnVuY3Rpb25zIiwiX3NpdGVtYXAiLCJzbSIsIl9wcmlzbWljIiwiZmV0Y2hBbGxQYWdlcyIsIl9yZWYiLCJyZWdlbmVyYXRvclJ1bnRpbWUiLCJtYXJrIiwiX2NhbGxlZSIsInBhZ2VTaXplIiwiYXBpIiwiYWxsUmVzdWx0cyIsImluaXRpYWwiLCJjdXJyZW50UGFnZSIsInJlc3BvbnNlIiwid3JhcCIsIl9jb250ZXh0IiwicHJldiIsIm5leHQiLCJnZXRBcGkiLCJzZW50IiwicXVlcnkiLCJwYWdlIiwicmVzdWx0cyIsInRvdGFsX3BhZ2VzIiwiYWJydXB0Iiwic3RvcCIsInVuZGVmaW5lZCIsImdldFVSTHNGcm9tUGFnZXMiLCJwYWdlcyIsInVybHMiLCJtYXAiLCJkb2N1bWVudCIsInB1c2giLCJ1cmwiLCJsaW5rUmVzb2x2ZXIiLCJzaXRlTWFwIiwiaHR0cHMiLCJvblJlcXVlc3QiLCJfcmVmMiIsIl9jYWxsZWUyIiwicmVxIiwicmVzIiwic2l0ZW1hcCIsIl9jb250ZXh0MiIsImNyZWF0ZVNpdGVtYXAiLCJob3N0bmFtZSIsInByb3RvY29sIiwiY2FjaGVUaW1lIiwidG9YTUwiLCJ4bWwiLCJzdGF0dXMiLCJlbmQiLCJoZWFkZXIiLCJzZXQiLCJzZW5kIiwiX3giLCJfeDIiLCJfcHJpc21pY0phdmFzY3JpcHQiLCJfcHJpc21pY0phdmFzY3JpcHQyIiwiYXBpRW5kcG9pbnQiLCJsb2FkU2V0dGluZ3MiLCJfY29udGVudCIsImRvYyIsInR5cGUiLCJ1aWQiLCJzdG9yZSIsIlByZWRpY2F0ZXMiLCJhdCIsImRpc3BhdGNoIiwiY29udGVudExvYWRlZCIsIkNPTlRFTlRfTE9BREVEIiwiQ09OVEVOVF9GRVRDSElORyIsImNvbnRlbnRGZXRjaGluZyIsImNvbnRlbnQiLCJwYXlsb2FkIl0sIm1hcHBpbmdzIjoiQ0FBQyxTQUFTQSxFQUFHQyxHQUFLLElBQUksR0FB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QUFrQixXQUM3QixPQUNFVCxLQUFNUSxJQUlHRixnQkFBZ0IsU0FBQ0ksRUFBU1YsRUFBTUMsR0FDM0MsT0FDRUQsS0FBTU8sRUFDTkksU0FDRUQsVUFDQVYsT0FDQUMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oZSwgYSkgeyBmb3IodmFyIGkgaW4gYSkgZVtpXSA9IGFbaV07IH0odGhpcywgLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJwcmlzbWljLWphdmFzY3JpcHRcIik7XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXG52YXIgX2ZpcmViYXNlRnVuY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblxudmFyIGZ1bmN0aW9ucyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9maXJlYmFzZUZ1bmN0aW9ucyk7XG5cbnZhciBfc2l0ZW1hcCA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cbnZhciBzbSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9zaXRlbWFwKTtcblxudmFyIF9wcmlzbWljID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH1cblxuZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfSBlbHNlIHsgcmV0dXJuIEFycmF5LmZyb20oYXJyKTsgfSB9XG5cbmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBnZW4gPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyBmdW5jdGlvbiBzdGVwKGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7IHN0ZXAoXCJuZXh0XCIsIHZhbHVlKTsgfSwgZnVuY3Rpb24gKGVycikgeyBzdGVwKFwidGhyb3dcIiwgZXJyKTsgfSk7IH0gfSByZXR1cm4gc3RlcChcIm5leHRcIik7IH0pOyB9OyB9XG5cbi8vIC8vIENyZWF0ZSBhbmQgRGVwbG95IFlvdXIgRmlyc3QgQ2xvdWQgRnVuY3Rpb25zXG4vLyAvLyBodHRwczovL2ZpcmViYXNlLmdvb2dsZS5jb20vZG9jcy9mdW5jdGlvbnMvd3JpdGUtZmlyZWJhc2UtZnVuY3Rpb25zXG4vL1xuLy8gZXhwb3J0cy5oZWxsb1dvcmxkID0gZnVuY3Rpb25zLmh0dHBzLm9uUmVxdWVzdCgocmVxdWVzdCwgcmVzcG9uc2UpID0+IHtcbi8vICByZXNwb25zZS5zZW5kKFwiSGVsbG8gZnJvbSBGaXJlYmFzZSFcIik7XG4vLyB9KTtcblxudmFyIGZldGNoQWxsUGFnZXMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkge1xuICAgIHZhciBwYWdlU2l6ZSwgYXBpLCBhbGxSZXN1bHRzLCBpbml0aWFsLCBjdXJyZW50UGFnZSwgcmVzcG9uc2U7XG4gICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcGFnZVNpemUgPSA1MDtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzO1xuICAgICAgICAgICAgcmV0dXJuICgwLCBfcHJpc21pYy5nZXRBcGkpKCk7XG5cbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBhcGkgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgYWxsUmVzdWx0cyA9IFtdO1xuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7XG4gICAgICAgICAgICByZXR1cm4gYXBpLnF1ZXJ5KFtdLCB7IHBhZ2VTaXplOiBwYWdlU2l6ZSwgcGFnZTogMSB9KTtcblxuICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIGluaXRpYWwgPSBfY29udGV4dC5zZW50O1xuXG4gICAgICAgICAgICBhbGxSZXN1bHRzID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhbGxSZXN1bHRzKSwgX3RvQ29uc3VtYWJsZUFycmF5KGluaXRpYWwucmVzdWx0cykpO1xuICAgICAgICAgICAgY3VycmVudFBhZ2UgPSAyO1xuXG4gICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgIGlmICghKGN1cnJlbnRQYWdlIDw9IGluaXRpYWwudG90YWxfcGFnZXMpKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMztcbiAgICAgICAgICAgIHJldHVybiBhcGkucXVlcnkoW10sIHsgcGFnZVNpemU6IHBhZ2VTaXplLCBwYWdlOiBjdXJyZW50UGFnZSB9KTtcblxuICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7XG5cbiAgICAgICAgICAgIGFsbFJlc3VsdHMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFsbFJlc3VsdHMpLCBfdG9Db25zdW1hYmxlQXJyYXkocmVzcG9uc2UucmVzdWx0cykpO1xuXG4gICAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlKys7XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgMTg6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIGFsbFJlc3VsdHMpO1xuXG4gICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZSwgdW5kZWZpbmVkKTtcbiAgfSkpO1xuXG4gIHJldHVybiBmdW5jdGlvbiBmZXRjaEFsbFBhZ2VzKCkge1xuICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG59KCk7XG5cbnZhciBnZXRVUkxzRnJvbVBhZ2VzID0gZnVuY3Rpb24gZ2V0VVJMc0Zyb21QYWdlcyhwYWdlcykge1xuICB2YXIgdXJscyA9IFtdO1xuICBwYWdlcy5tYXAoZnVuY3Rpb24gKGRvY3VtZW50KSB7XG4gICAgdXJscy5wdXNoKHtcbiAgICAgIHVybDogKDAsIF9wcmlzbWljLmxpbmtSZXNvbHZlcikoZG9jdW1lbnQpXG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gdXJscztcbn07XG5cbmV4cG9ydHMuc2l0ZU1hcCA9IGZ1bmN0aW9ucy5odHRwcy5vblJlcXVlc3QoZnVuY3Rpb24gKCkge1xuICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHJlcSwgcmVzKSB7XG4gICAgdmFyIHBhZ2VzLCBzaXRlbWFwO1xuICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7XG4gICAgICAgICAgICByZXR1cm4gZmV0Y2hBbGxQYWdlcygpO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcGFnZXMgPSBfY29udGV4dDIuc2VudDtcbiAgICAgICAgICAgIHNpdGVtYXAgPSBzbS5jcmVhdGVTaXRlbWFwKHtcbiAgICAgICAgICAgICAgaG9zdG5hbWU6IHJlcS5wcm90b2NvbCArIFwiOi8vXCIgKyByZXEuaG9zdG5hbWUsXG4gICAgICAgICAgICAgIGNhY2hlVGltZTogNjAwMDAwLFxuICAgICAgICAgICAgICB1cmxzOiBnZXRVUkxzRnJvbVBhZ2VzKHBhZ2VzKVxuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgc2l0ZW1hcC50b1hNTChmdW5jdGlvbiAoZXJyLCB4bWwpIHtcbiAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuZW5kKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmVzLmhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL3htbCcpO1xuICAgICAgICAgICAgICByZXMuc2V0KCdDYWNoZS1Db250cm9sJywgJ3B1YmxpYywgbWF4LWFnZT0xODAwLCBzLW1heGFnZT0zNjAwJyk7XG4gICAgICAgICAgICAgIHJlcy5zZW5kKHhtbCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUyLCB1bmRlZmluZWQpO1xuICB9KSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyKSB7XG4gICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG59KCkpO1xuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcG9seWZpbGxcIik7XG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJmaXJlYmFzZS1mdW5jdGlvbnNcIik7XG5cbi8qKiovIH0pLFxuLyogNCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJzaXRlbWFwXCIpO1xuXG4vKioqLyB9KSxcbi8qIDUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMubGlua1Jlc29sdmVyID0gZXhwb3J0cy5nZXRBcGkgPSB1bmRlZmluZWQ7XG5cbnZhciBfcHJpc21pY0phdmFzY3JpcHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgX3ByaXNtaWNKYXZhc2NyaXB0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ByaXNtaWNKYXZhc2NyaXB0KTtcblxudmFyIF9wcmlzbWljID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IGZ1bmN0aW9uIHN0ZXAoa2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHsgc3RlcChcIm5leHRcIiwgdmFsdWUpOyB9LCBmdW5jdGlvbiAoZXJyKSB7IHN0ZXAoXCJ0aHJvd1wiLCBlcnIpOyB9KTsgfSB9IHJldHVybiBzdGVwKFwibmV4dFwiKTsgfSk7IH07IH1cblxudmFyIGdldEFwaSA9IGV4cG9ydHMuZ2V0QXBpID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHtcbiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjtcbiAgICAgICAgICAgIHJldHVybiBfcHJpc21pY0phdmFzY3JpcHQyLmRlZmF1bHQuZ2V0QXBpKF9wcmlzbWljLmFwaUVuZHBvaW50KTtcblxuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQuc2VudCk7XG5cbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHVuZGVmaW5lZCk7XG4gIH0pKTtcblxuICByZXR1cm4gZnVuY3Rpb24gZ2V0QXBpKCkge1xuICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG59KCk7XG5cbnZhciBsaW5rUmVzb2x2ZXIgPSBleHBvcnRzLmxpbmtSZXNvbHZlciA9IF9wcmlzbWljLmxpbmtSZXNvbHZlcjtcblxuLyoqKi8gfSksXG4vKiA2ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmxvYWRTZXR0aW5ncyA9IGV4cG9ydHMubGlua1Jlc29sdmVyID0gZXhwb3J0cy5nZXRBcGkgPSBleHBvcnRzLmFwaUVuZHBvaW50ID0gdW5kZWZpbmVkO1xuXG52YXIgX3ByaXNtaWNKYXZhc2NyaXB0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxudmFyIF9wcmlzbWljSmF2YXNjcmlwdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcmlzbWljSmF2YXNjcmlwdCk7XG5cbnZhciBfY29udGVudCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBnZW4gPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyBmdW5jdGlvbiBzdGVwKGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7IHN0ZXAoXCJuZXh0XCIsIHZhbHVlKTsgfSwgZnVuY3Rpb24gKGVycikgeyBzdGVwKFwidGhyb3dcIiwgZXJyKTsgfSk7IH0gfSByZXR1cm4gc3RlcChcIm5leHRcIik7IH0pOyB9OyB9XG5cbnZhciBhcGlFbmRwb2ludCA9IGV4cG9ydHMuYXBpRW5kcG9pbnQgPSBcImh0dHBzOi8vcmFwaGFlbHRtLnByaXNtaWMuaW8vYXBpL3YyXCI7XG5cbnZhciBnZXRBcGkgPSBleHBvcnRzLmdldEFwaSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7XG4gICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7XG4gICAgICAgICAgICByZXR1cm4gX3ByaXNtaWNKYXZhc2NyaXB0Mi5kZWZhdWx0LmdldEFwaShhcGlFbmRwb2ludCk7XG5cbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIF9jb250ZXh0LnNlbnQpO1xuXG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB1bmRlZmluZWQpO1xuICB9KSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIGdldEFwaSgpIHtcbiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xufSgpO1xuXG52YXIgbGlua1Jlc29sdmVyID0gZXhwb3J0cy5saW5rUmVzb2x2ZXIgPSBmdW5jdGlvbiBsaW5rUmVzb2x2ZXIoZG9jKSB7XG4gIGlmIChkb2MudHlwZSA9PT0gXCJob21lcGFnZVwiKSB7XG4gICAgcmV0dXJuICcvJztcbiAgfVxuICByZXR1cm4gXCIvXCIgKyBkb2MudHlwZSArIFwiL1wiICsgKGRvYy51aWQgfHwgJycpO1xufTtcblxudmFyIGxvYWRTZXR0aW5ncyA9IGV4cG9ydHMubG9hZFNldHRpbmdzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHN0b3JlKSB7XG4gICAgdmFyIGFwaSwgcmVzcG9uc2U7XG4gICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjtcbiAgICAgICAgICAgIHJldHVybiBnZXRBcGkoKTtcblxuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0Mi5zZW50O1xuICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1O1xuICAgICAgICAgICAgcmV0dXJuIGFwaS5xdWVyeShfcHJpc21pY0phdmFzY3JpcHQyLmRlZmF1bHQuUHJlZGljYXRlcy5hdCgnZG9jdW1lbnQudHlwZScsICdzZXR0aW5ncycpKTtcblxuICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQyLnNlbnQ7XG5cblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCgwLCBfY29udGVudC5jb250ZW50TG9hZGVkKShyZXNwb25zZS5yZXN1bHRzWzBdLCAnc2V0dGluZ3MnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCByZXNwb25zZS5yZXN1bHRzWzBdKTtcblxuICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUyLCB1bmRlZmluZWQpO1xuICB9KSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIGxvYWRTZXR0aW5ncyhfeCkge1xuICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xufSgpO1xuXG4vKioqLyB9KSxcbi8qIDcgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbnZhciBDT05URU5UX0xPQURFRCA9IGV4cG9ydHMuQ09OVEVOVF9MT0FERUQgPSBcIkNPTlRFTlRfTE9BREVEXCI7XG52YXIgQ09OVEVOVF9GRVRDSElORyA9IGV4cG9ydHMuQ09OVEVOVF9GRVRDSElORyA9IFwiQ09OVEVOVF9GRVRDSElOR1wiO1xuXG52YXIgY29udGVudEZldGNoaW5nID0gZXhwb3J0cy5jb250ZW50RmV0Y2hpbmcgPSBmdW5jdGlvbiBjb250ZW50RmV0Y2hpbmcoKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogQ09OVEVOVF9GRVRDSElOR1xuICB9O1xufTtcblxudmFyIGNvbnRlbnRMb2FkZWQgPSBleHBvcnRzLmNvbnRlbnRMb2FkZWQgPSBmdW5jdGlvbiBjb250ZW50TG9hZGVkKGNvbnRlbnQsIHR5cGUsIHVpZCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IENPTlRFTlRfTE9BREVELFxuICAgIHBheWxvYWQ6IHtcbiAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICB0eXBlOiB0eXBlLFxuICAgICAgdWlkOiB1aWRcbiAgICB9XG4gIH07XG59O1xuXG4vKioqLyB9KVxuLyoqKioqKi8gXSkpKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gaW5kZXguanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCBkMGMwODZhZDFmNTBiODdjOTBlOSIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInByaXNtaWMtamF2YXNjcmlwdFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInByaXNtaWMtamF2YXNjcmlwdFwiXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBcImJhYmVsLXBvbHlmaWxsXCI7XG5pbXBvcnQgKiBhcyBmdW5jdGlvbnMgZnJvbSBcImZpcmViYXNlLWZ1bmN0aW9uc1wiO1xuaW1wb3J0ICogYXMgc20gZnJvbSBcInNpdGVtYXBcIjtcbmltcG9ydCB7Z2V0QXBpLCBsaW5rUmVzb2x2ZXJ9IGZyb20gXCIuL3ByaXNtaWNcIjtcblxuLy8gLy8gQ3JlYXRlIGFuZCBEZXBsb3kgWW91ciBGaXJzdCBDbG91ZCBGdW5jdGlvbnNcbi8vIC8vIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL2Z1bmN0aW9ucy93cml0ZS1maXJlYmFzZS1mdW5jdGlvbnNcbi8vXG4vLyBleHBvcnRzLmhlbGxvV29ybGQgPSBmdW5jdGlvbnMuaHR0cHMub25SZXF1ZXN0KChyZXF1ZXN0LCByZXNwb25zZSkgPT4ge1xuLy8gIHJlc3BvbnNlLnNlbmQoXCJIZWxsbyBmcm9tIEZpcmViYXNlIVwiKTtcbi8vIH0pO1xuXG5jb25zdCBmZXRjaEFsbFBhZ2VzID0gYXN5bmMgKCkgPT4ge1xuICBjb25zdCBwYWdlU2l6ZSA9IDUwO1xuICBjb25zdCBhcGkgPSBhd2FpdCBnZXRBcGkoKTtcbiAgbGV0IGFsbFJlc3VsdHMgPSBbXTtcbiAgY29uc3QgaW5pdGlhbCA9IGF3YWl0IGFwaS5xdWVyeShbXSwge3BhZ2VTaXplOiBwYWdlU2l6ZSwgcGFnZTogMX0pO1xuICBhbGxSZXN1bHRzID0gWy4uLmFsbFJlc3VsdHMsIC4uLmluaXRpYWwucmVzdWx0c107XG4gIGZvciAobGV0IGN1cnJlbnRQYWdlID0gMjsgY3VycmVudFBhZ2UgPD0gaW5pdGlhbC50b3RhbF9wYWdlczsgY3VycmVudFBhZ2UrKykge1xuICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGFwaS5xdWVyeShbXSwge3BhZ2VTaXplOiBwYWdlU2l6ZSwgcGFnZTogY3VycmVudFBhZ2V9KTtcbiAgICBhbGxSZXN1bHRzID0gWy4uLmFsbFJlc3VsdHMsIC4uLnJlc3BvbnNlLnJlc3VsdHNdO1xuICB9XG4gIHJldHVybiBhbGxSZXN1bHRzO1xufTtcblxuY29uc3QgZ2V0VVJMc0Zyb21QYWdlcyA9IChwYWdlcykgPT4ge1xuICBsZXQgdXJscyA9IFtdO1xuICBwYWdlcy5tYXAoKGRvY3VtZW50KSA9PiB7XG4gICAgdXJscy5wdXNoKHtcbiAgICAgIHVybDogbGlua1Jlc29sdmVyKGRvY3VtZW50KVxuICAgIH0pO1xuICB9KTtcbiAgcmV0dXJuIHVybHM7XG59O1xuXG5leHBvcnRzLnNpdGVNYXAgPSBmdW5jdGlvbnMuaHR0cHMub25SZXF1ZXN0KGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICBjb25zdCBwYWdlcyA9IGF3YWl0IGZldGNoQWxsUGFnZXMoKTtcblxuICBjb25zdCBzaXRlbWFwID0gc20uY3JlYXRlU2l0ZW1hcCh7XG4gICAgaG9zdG5hbWU6IGAke3JlcS5wcm90b2NvbH06Ly8ke3JlcS5ob3N0bmFtZX1gLFxuICAgIGNhY2hlVGltZTogNjAwMDAwLFxuICAgIHVybHM6IGdldFVSTHNGcm9tUGFnZXMocGFnZXMpXG4gIH0pO1xuXG4gIHNpdGVtYXAudG9YTUwoZnVuY3Rpb24gKGVyciwgeG1sKSB7XG4gICAgaWYgKGVycikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5lbmQoKTtcbiAgICB9XG4gICAgcmVzLmhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL3htbCcpO1xuICAgIHJlcy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCAncHVibGljLCBtYXgtYWdlPTE4MDAsIHMtbWF4YWdlPTM2MDAnKTtcbiAgICByZXMuc2VuZCh4bWwpO1xuICB9KTtcbn0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC5qcyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJhYmVsLXBvbHlmaWxsXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiYmFiZWwtcG9seWZpbGxcIlxuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJmaXJlYmFzZS1mdW5jdGlvbnNcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJmaXJlYmFzZS1mdW5jdGlvbnNcIlxuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJzaXRlbWFwXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwic2l0ZW1hcFwiXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBQcmlzbWljIGZyb20gXCJwcmlzbWljLWphdmFzY3JpcHRcIjtcclxuaW1wb3J0IHthcGlFbmRwb2ludCwgbGlua1Jlc29sdmVyIGFzIGxyfSBmcm9tIFwiLi4vLi4vc3JjL3ByaXNtaWNcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRBcGkgPSBhc3luYyAoKSA9PiB7XHJcbiAgcmV0dXJuIGF3YWl0IFByaXNtaWMuZ2V0QXBpKGFwaUVuZHBvaW50KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBsaW5rUmVzb2x2ZXIgPSBscjtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvcHJpc21pYy5qcyIsImltcG9ydCBQcmlzbWljIGZyb20gXCJwcmlzbWljLWphdmFzY3JpcHRcIjtcclxuaW1wb3J0IHtjb250ZW50TG9hZGVkfSBmcm9tIFwiLi9hY3Rpb25zL2NvbnRlbnRcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBhcGlFbmRwb2ludCA9IFwiaHR0cHM6Ly9yYXBoYWVsdG0ucHJpc21pYy5pby9hcGkvdjJcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRBcGkgPSBhc3luYyAoKSA9PiB7XHJcbiAgcmV0dXJuIGF3YWl0IFByaXNtaWMuZ2V0QXBpKGFwaUVuZHBvaW50KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBsaW5rUmVzb2x2ZXIgPSAoZG9jKSA9PiB7XHJcbiAgaWYoZG9jLnR5cGUgPT09IFwiaG9tZXBhZ2VcIil7XHJcbiAgICByZXR1cm4gJy8nO1xyXG4gIH1cclxuICByZXR1cm4gYC8ke2RvYy50eXBlfS9gICsgKGRvYy51aWQgfHwgJycpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGxvYWRTZXR0aW5ncyA9IGFzeW5jIChzdG9yZSkgPT4ge1xyXG4gIGNvbnN0IGFwaSA9IGF3YWl0IGdldEFwaSgpO1xyXG4gIGxldCByZXNwb25zZSA9IGF3YWl0IGFwaS5xdWVyeShQcmlzbWljLlByZWRpY2F0ZXMuYXQoJ2RvY3VtZW50LnR5cGUnLCAnc2V0dGluZ3MnKSk7XHJcblxyXG4gIGlmKHJlc3BvbnNlLnJlc3VsdHMubGVuZ3RoID09PSAxKXtcclxuICAgIHN0b3JlLmRpc3BhdGNoKGNvbnRlbnRMb2FkZWQocmVzcG9uc2UucmVzdWx0c1swXSwgJ3NldHRpbmdzJykpO1xyXG4gIH1cclxuICByZXR1cm4gcmVzcG9uc2UucmVzdWx0c1swXTtcclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi8uLi9zcmMvcHJpc21pYy5qcyIsImV4cG9ydCBjb25zdCBDT05URU5UX0xPQURFRCA9IFwiQ09OVEVOVF9MT0FERURcIjtcbmV4cG9ydCBjb25zdCBDT05URU5UX0ZFVENISU5HID0gXCJDT05URU5UX0ZFVENISU5HXCI7XG5cbmV4cG9ydCBjb25zdCBjb250ZW50RmV0Y2hpbmcgPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogQ09OVEVOVF9GRVRDSElOR1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgY29udGVudExvYWRlZCA9IChjb250ZW50LCB0eXBlLCB1aWQpID0+IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBDT05URU5UX0xPQURFRCxcbiAgICBwYXlsb2FkOiB7XG4gICAgICBjb250ZW50LFxuICAgICAgdHlwZSxcbiAgICAgIHVpZCxcbiAgICB9XG4gIH07XG59O1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuLy4uL3NyYy9hY3Rpb25zL2NvbnRlbnQuanMiXSwic291cmNlUm9vdCI6IiJ9